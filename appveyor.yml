version: 1.0.{build}
os: Visual Studio 2015
init:
- cmd: >-
    echo %APPVEYOR_BUILD_VERSION%

    git config --global core.autocrlf true

    mkdir ..\..\..\keys\antlr

    "C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6 Tools\sn.exe" -k ..\..\..\keys\antlr\Key.snk
install:
- git submodule update --init --recursive
build_script:
- cd build\prep
- ps: |
    $suffix = Get-Date -format "yyyyMMddhhmm"
    Write-Host $suffix
    .\prepare.ps1 -Logger "${env:ProgramFiles}\AppVeyor\BuildAgent\Appveyor.MSBuildLogger.dll" -versionsuffix "dev-$suffix"
- cd ..\..
test: off
artifacts:
- path: build\prep\nuget\*.nupkg
- path: build\prep\dist\*.7z
